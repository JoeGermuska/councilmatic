{% extends "base.html" %}
{% load model_blocks %}

{% block load_early %}
  <link rel="stylesheet" href="{{ STATIC_URL }}phillyleg/legislation.css">
{% endblock %}

{% block content %}
  {% if user.is_authenticated %}
    {% if user in object.bookmarks.all %}
      <div class="bookmark active">
        <a href="remove_bookmark?next={{ request.get_full_path }}"><img src="{{ STATIC_URL }}bookmarks/bookmark_active.png" alt="Unbookmark"></a>
      </div>
    {% else %}
      <div class="bookmark inactive">
        <a href="add_bookmark?next={{ request.get_full_path }}"><img src="{{ STATIC_URL }}bookmarks/bookmark.png" alt="Bookmark"></a>
      </div>
    {% endif %}
  {% endif %}
  
  <div id="main">
    {% with phillyleg_legfile_detail_template="phillyleg/partials/legfile_detail.html" %}
    {% with phillyleg_legfile_exclude="date_scraped, last_scraped, legfileattachment_set, legaction_set, metadata, type, status" %}
    {% with phillyleg_legfile_fields="intro_date, final_date, controlling_body, sponsors, contact, title, url" %}
      {% detail_block object %}
    {% endwith %}
    {% endwith %}
    {% endwith %}
  </div>
  
  <div id="sidebar">
    {% if object.sponsors.all|length %}
      <div class="instance_field legfile_sponsors">
        <h3 class="instance_field_label legfile_sponsors_label">{{ object.sponsors.all|length }} Sponsor{{ object.sponsors.all|length|pluralize }} from Council</h3>
        <ul class="instance_field_value legfile_sponsors_value">
          {% for sponsor in object.sponsors.all %}
            <li><img width="40" src="{{STATIC_URL}}{{ sponsor.headshot }}" alt="{{ sponsor.name }}"><span>{{ sponsor.name }}<span></li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}
    
    {% if object.metadata.mentioned_legfiles.all %}
      <div class="block">
        <h3>Bills mentioned in this file</h3>
        <ul class="navigation">
          {% for mentioned_legfile in object.metadata.mentioned_legfiles.all %}
            <li><a href="{{ mentioned_legfile.get_absolute_url }}">{{ mentioned_legfile }}</a></li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}
  </div>
{% endblock %}
